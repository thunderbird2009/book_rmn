<!-- Medium Zoom for Images and SVGs -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script>

<style>
  .medium-zoom-overlay, .medium-zoom-image--opened {
    z-index: 9999 !important;
  }
  img, .mermaid svg {
    cursor: zoom-in;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Attach to standard images
    mediumZoom('img', { margin: 24, background: '#2d2d2d' });
    
    // Polling to attach to Mermaid SVGs as they appear
    // This ensures we catch them whenever Mermaid finishes rendering
    setInterval(() => {
      const svgs = document.querySelectorAll('.mermaid svg');
      svgs.forEach(svg => {
        // Only attach if not already attached (medium-zoom adds this class)
        if (!svg.classList.contains('medium-zoom-image')) {
          mediumZoom(svg, { margin: 24, background: '#2d2d2d' });
        }
      });
    }, 1000);
  });
</script>

<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: false });

  document.addEventListener('DOMContentLoaded', () => {
    const mermaidBlocks = document.querySelectorAll('pre code.language-mermaid');
    mermaidBlocks.forEach((block) => {
      const content = block.textContent;
      const div = document.createElement('div');
      div.className = 'mermaid';
      div.textContent = content;
      block.parentElement.replaceWith(div);
    });
    
    mermaid.run();
  });
</script>

<!-- MathJax Configuration -->
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
